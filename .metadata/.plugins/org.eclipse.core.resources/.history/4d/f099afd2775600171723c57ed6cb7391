/**
 * 
 */
package org.fmaes.simppaal.simulinktotimedautomata.core.types.wrappers;

import java.util.ArrayList;
import java.util.Collection;
import java.util.Dictionary;

import org.conqat.lib.simulink.model.SimulinkModel;
import org.fmaes.simppaal.simulinktotimedautomata.core.configuration.ApplicationConfiguration;
import org.fmaes.simppaal.simulinktotimedautomata.core.loaders.SimulinkModelLoader;
import org.fmaes.simppaal.simulinktotimedautomata.core.types.hierarchy.HierarchyNode;
import org.fmaes.simppaal.simulinktotimedautomata.core.types.hierarchy.HierarchyTree;;

/**
 * @author Predrag Filipovikj (predrag.filipovikj@mdh.se)
 *
 */
public class SimulinkSystemModel {

  private HierarchyTree modelHierarcyTree;
  private SimulinkModelLoader simulinkModelLoader;

  public SimulinkSystemModel(ApplicationConfiguration _appConfig, String rootModelName) {
    simulinkModelLoader = new SimulinkModelLoader(_appConfig);
    loadHierarchy(rootModelName);
  }

  private void loadHierarchy(String rootModelName) {
    SimulinkModelWrapper wrappedRootModel =
        simulinkModelLoader.loadAndWrapSimulinkModelByName(rootModelName);
    HierarchyNode hNode = new HierarchyNode(rootModelName);
    addEntryToHierarchy(hNode);
  }

  private void loadReferencedModels(HierarchyNode parentNode,
      SimulinkModelWrapper wrappedSimulinkModel) {
    Collection<SimulinkBlockWrapper> externalReferenceBlocks =
        wrappedSimulinkModel.getExternalReferencedModelBlocks();
    for (SimulinkBlockWrapper externalReferenceBlock : externalReferenceBlocks) {
      loadReferencedModel(parentNode, externalReferenceBlock);
    }

  }

  private void loadReferencedModel(HierarchyNode parentNode,
      SimulinkBlockWrapper referencedSimulinkBlock) {

  }

  private void addEntryToHierarchy(HierarchyNode _node) {
    modelHierarcyTree.add(_node);
  }

  private void addEntryToModelsList(SimulinkModelWrapper _wrappedSimulinkModel) {
    String modelName = _wrappedSimulinkModel.getModelName();
    if (simulinkModelFiles.get(modelName) == null) {
      simulinkModelFiles.put(modelName, _wrappedSimulinkModel);
    }
  }

}
